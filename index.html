<!DOCTYPE html>
<html>
  <head>
    <title>Grow a Garden - Sign Up</title>
    <meta charset="UTF-8" />
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <style>
      body {
        background-color: black;
        border: 2px solid lightslategray;
        padding: 15px 20px;
        font-family: 'Times New Roman', Times, serif;
        color: gray;
      }
      h1, h2, p {
        color: gray;
      }
      button {
        background-color: #2c2c2c;
        border: 2px solid #1a1a1a;
        color: #f5f5f5;
        padding: 15px 20px;
        cursor: pointer;
        border-radius: 8px;
        transition: background-color 0.3s, border-color 0.3s, color 0.3s;
      }
      button:hover {
        background-color: #3d3d3d;
        border-color: #444;
        color: #ffffff;
      }
      button:active {
        background-color: #1a1a1a;
        border-color: #555;
        color: #dddddd;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel" data-type="module" data-presets="react,typescript">
      type FormData = {
        email: string;
        username: string;
        password: string;
      };

      function SignupForm() {
        const [formData, setFormData] = React.useState<FormData>({
          email: "",
          username: "",
          password: ""
        });

        const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
          setFormData({ ...formData, [e.target.name]: e.target.value });
        };

        const handleSubmit = async (e: React.FormEvent) => {
          e.preventDefault();
          const res = await fetch("/functions/database.tsx", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(formData)
          });
          alert((await res.text()) || "Submitted.");
        };

        return (
          <form onSubmit={handleSubmit}>
            <h2>Sign Up</h2>
            <input name="email" type="email" placeholder="Email" required onChange={handleChange} /><br /><br />
            <input name="username" type="text" placeholder="Username" required onChange={handleChange} /><br /><br />
            <input name="password" type="password" placeholder="Password" required onChange={handleChange} /><br /><br />
            <div className="cf-turnstile" data-sitekey="0x4AAAAAABeDBe4pSr2MmYDv"></div><br />
            <button type="submit">Submit</button>
          </form>
        );
      }

      ReactDOM.render(<SignupForm />, document.getElementById("root"));
    </script>
  </body>
</html>
